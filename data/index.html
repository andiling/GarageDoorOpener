<!DOCTYPE html> <html> <head> <title>Configure your Garage Door Opener</title> <meta name="viewport" content="width=device-width, initial-scale=1"> <style>html, body, div, span, h1, form, label, section, p{ margin:0;padding:0;border:0;font-size:100%;font:inherit;vertical-align:baseline;}html{ color:#333;font-size:20px;line-height:20px;font-family:'Helvetica Neue', Helvetica, Arial, sans-serif;}body{ font-size:14px;font-style:normal;font-variant:normal;font-weight:400;line-height:20px;display:flex;height:100vh;width:100vw;background-color:#efefef;}.container{ width:100%;max-width:20rem;margin:auto;flex:1 1 100%;background-color:#fff;padding:1rem;}@media screen and (min-width:26rem){ .container{ box-shadow:0 0 4px rgba(0, 0, 0, 0.2);border-radius:3px;}}header{ font-size:1.2rem;line-height:1.5rem;font-style:normal;font-variant:normal;font-weight:700;padding-top:6.5px;text-align:center;margin:0 auto 13.5px;width:100%;max-width:20rem;}form{ width:100%;max-width:15rem;margin:0 auto;padding-bottom:1rem;}label{ display:block;padding-top:5px;margin-bottom:5px;}.wrapper{ display:block;width:100%;height:40px;margin-bottom:1rem;}input, button, select{ width:100%;height:100%;padding:5px 0.5rem;max-width:20rem;box-sizing:border-box;border:1px solid #ccc;}button{ margin-top:1rem;background-color:#29506D;color:#fff;border:0 none;text-transform:uppercase;padding:13px 1rem;font-weight:700;border-radius:5px;}.hidden{ display:none;}.notification{ background-color:#CDE4F5;border:1px solid #84B0D2;color:#29506D;padding:5px 1rem;margin:0 auto 15px;max-width:13rem;}.error{ background-color:#FFD4D3;border:1px solid #FFAFAD;color:#D46D6A;}.inline-error{ color:#D46D6A;}button:disabled{ background-color:#aaa;}button:hover{ transition:background-color linear 0.2s;background-color:#496D89;cursor:pointer;}button:disabled:hover{ background-color:#aaa;cursor:default;}</style> </head> <body> <div class="container"> <header> <h1>Configure your Garage Door Opener</h1> </header> <div class="notification hidden" id="notification">Your settings have been saved! You can now re-connect to your regular WIFI network</div> <div class="notification error hidden" id="error"></div> <section> <form action="post" method="/save" id="form"> <div id="ssid-wrapper"> <label for="ssid">SSID</label> <span class="wrapper"><select id="ssid" disabled><option>Scanning...</option></select></span> </div> <div id="passkey-wrapper" class="hidden"> <label for="passkey"> Passkey <span class="inline-error hidden" id="passkey-error"></span> </label> <span class="wrapper"><input type="text" id="passkey" name="passkey"></span> </div> <span class="wrapper"><button id="button" disabled>Connect</button></span> </form> </section> </div> <script>!function(){function n(){return Object.assign.apply(this,arguments)}function e(n,e,t,a,i){var s=new XMLHttpRequest;s.open(e,n),s.onreadystatechange=function(){4==s.readyState&&(200==s.status?a(s.responseText):422==s.status&&i(s.responseText))},t?s.send(t):s.send()}function t(e,t){switch(t.type){case C:return 0==t.aps.length?null:n({},t.aps[0]);case H:return n({},t.ap)}return e}function a(e,t){if(t.type==M){var a=t.value.length>0&&t.value.length<=32;return n({},e,{value:t.value,valid:a,changed:!0})}return e}function i(n,e){return e.type==I?e.message:n}function s(n,e){return e.type==C?e.aps:n}function o(n,e){switch(e.type){case A:case C:case G:case I:return e.type;default:return n}}function c(e){var c=n({},J);J=n({},c);var u=n({},J.ui);u.passkey=a(u.passkey,e),J.error=i(J.error,e),J.ap=t(J.ap,e),J.aps=s(J.aps,e),J.connection=o(J.connection,e),J.ui=u,E(J,c)}function u(n){return document.getElementById(n)}function r(n,e){if(n.className.indexOf(e)===-1){var t=n.className.split(" ");t.push(e),n.className=t.join(" ")}}function p(n,e){var t=n.className.split(" "),a=t.indexOf(e);a!==-1&&(t.splice(a,1),n.className=t.join(" "))}function l(n){n.removeAttribute(P)}function f(n){n.setAttribute(P,P)}function v(n){p(n,R)}function y(n){r(n,R)}function d(n,e){n.innerHTML=e}function k(n,e){if(n.connection!==e.connection){var t=u("ssid");switch(n.connection){case q:case A:f(t);break;default:l(t)}}}function g(n,e){if(n.connection!==e.connection||n.aps!==e.aps||n.ap!==e.ap){var t=u("ssid"),a=n.aps,i=n.connection,s=n.ap;if(i===A)d(t,"<option>Scanning...</option>");else if(i===q||0==a.length)d(t,"");else{for(var o=[],c=0;c<a.length;c++){var r=a[c];o.push('<option value="'+r.ssid+'"'+(s.ssid==r.ssid?" selected":"")+">"+r.ssid+"</option>")}d(t,o.join(""))}}}function h(n,e){if(n.ui.passkey.value!==e.ui.passkey.value){var t=u("passkey");t.value=n.ui.passkey.value}}function m(n,e){var t=n.ap?n.ap.encryption:null,a=e.ap?e.ap.encryption:null,i=n.ui.passkey.value===e.ui.passkey.value;if(i=i&&t===a,!i){var s=u("passkey-wrapper");7==t?y(s):v(s)}}function b(n,e){var t=n.ui.passkey.changed===e.ui.passkey.changed;if(t=t&&n.ui.passkey.valid===e.ui.passkey.valid,t=t&&n.ui.passkey.value===e.ui.passkey.value,!t){var a=n.ui.passkey.value,i=u("passkey-error");n.ui.passkey.changed&&!n.ui.passkey.valid?(0==a.length?d(i,"is required"):a.length>=32&&d(i,"is too long"),v(i)):y(i)}}function w(n,e){var t=n.ap?n.ap.encryption:null,a=e.ap?e.ap.encryption:null,i=n.ui.passkey.valid===e.ui.passkey.valid;if(i=i&&n.connection===e.connection,i=i&&t===a,!i){var s=u("button");n.connection!==C||7!==t&&!n.ui.passkey.valid?f(s):l(s)}}function L(n,e){if(n.connection!==e.connection){var t=u("button");n.connection===B?d(t,"Connecting..."):d(t,"Connect")}}function N(n,e){if(n.connection!==e.connection){var t=u("form");n.connection===G?y(t):v(t)}}function T(n,e){if(n.connection!==e.connection){var t=u("notification");n.connection===G?v(t):y(t)}}function j(n,e){if(n.connection!==e.connection){var t=u("error");n.connection===I?(t.innerHTML=n.error,v(t)):y(t)}}function E(n,e){k(n,e),g(n,e),h(n,e),m(n,e),b(n,e),w(n,e),L(n,e),N(n,e),T(n,e),j(n,e)}function O(){c({type:A}),e("/browse.json","GET",null,function(n){c({type:C,aps:JSON.parse(n)})})}function x(n){n.preventDefault();for(var e=null,t=J.aps,a=0;a<t.length;a++)t[a].ssid==n.target.value&&(e=t[a]);c({type:H,ap:e})}function S(n){n.preventDefault(),c({type:M,value:n.target.value})}function D(n){n.preventDefault();var t=J.ap.ssid,a=J.ui.passkey.value,i="ssid="+t;7!=J.ap.encryption&&(i+="&passkey="+a),c({type:B}),e("/save","POST",i,function(){c({type:G})},function(n){c({type:I,message:n})})}var H=4,M=5,q=6,A=7,C=8,B=9,G=10,I=11,J={ui:{passkey:{changed:!1,valid:!1,error:null,value:""}},aps:[],ap:null,error:"",connection:q},P="disabled",R="hidden";u("ssid").addEventListener("change",x,!0),u("passkey").addEventListener("input",S,!0),u("form").addEventListener("submit",D,!0),O()}();</script> </body> </html> 
